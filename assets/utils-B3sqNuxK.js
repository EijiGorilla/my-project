const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/symbolLayerUtils-Zyp81Swx.js","assets/index-Bncuv2b3.js","assets/index-D_89hqeg.css"])))=>i.map(i=>d[i]);
import{bW as b,V as s,lh as y,li as d,lj as w,lk as k,ll as g,j as L}from"./index-Bncuv2b3.js";import{S as v,u as z}from"./cimSymbolUtils-BXs1V6r7.js";new b(1e3);new s([128,128,128]);function I(n){if(n==null||!("symbolLayers"in n)||n.symbolLayers==null)return!1;switch(n.type){case"point-3d":return n.symbolLayers.some(r=>r.type==="object");case"line-3d":return n.symbolLayers.some(r=>r.type==="path");case"polygon-3d":return n.symbolLayers.some(r=>r.type==="object"||r.type==="extrude");default:return!1}}function J(n){return n.resource?.href??""}function M(n,r){if(!n)return null;let l=null;return y(n)?l=j(n):d(n)&&(l=n.type==="cim"?z(n):n.color?new s(n.color):null),l?u(l,r):null}function j(n){const r=n.symbolLayers;if(!r)return null;let l=null;return r.forEach(o=>{o.type==="object"&&o.resource?.href||(l=o.type==="water"?o.color:o.material?o.material.color:null)}),l?new s(l):null}function u(n,r){if(r==null||n==null)return n;const l=n.toRgba();return l[3]=l[3]*r,new s(l)}function S(n,r,l){const o=n.symbolLayers;if(!o)return;const t=(e,c=!1)=>{let i=r??e??null;return l?.override!=null&&(!i&&c&&(i=new s([255,255,255])),i&&(i.a=l.override)),u(i,l?.add)};o.forEach(e=>{if(e.type==="water")return void(e.color=u(e.color,l?.add));const c=e.material!=null?e.material.color:null,i=t(c,e.type==="icon"&&e.resource?.href!=null);e.material==null?e.material=new w({color:i}):e.material.color=i,"outline"in e&&e.outline?.color&&l?.add!=null&&(e.outline.color=u(e.outline.color,l.add)),"marker"in e&&e.marker!=null&&(e.marker.color=t(e.marker.color))})}function x(n,r,l){r=r??n.color,l?.override!=null&&r&&(r.a=l.override),r&&(n.color=u(r,l?.add)),"outline"in n&&n.outline?.color&&(n.outline.color=u(n.outline.color,l?.add))}function N(n,r,l){n&&(r||l!=null)&&(r&&(r=new s(r)),y(n)?S(n,r,l):d(n)&&x(n,r,l))}async function _(n,r){const l=n.symbolLayers;l&&await k(l,async o=>E(o,r))}async function E(n,r){switch(n.type){case"extrude":R(n,r);break;case"icon":case"line":case"text":$(n,r);break;case"path":A(n,r);break;case"object":await O(n,r)}}function $(n,r){const l=m(r);l!=null&&(n.size=l)}function m(n){for(const r of n)if(typeof r=="number")return r;return null}function R(n,r){const l=r[2];typeof l=="number"&&(n.size=l)}async function O(n,r){const{resourceSize:l,symbolSize:o}=await D(n),t=p(r,l,o);t!=null&&(n.width=f(r[0],o[0],l[0],t),n.depth=f(r[1],o[1],l[1],t),n.height=f(r[2],o[2],l[2],t))}function A(n,r){const l=p(r,g,[n.width,void 0,n.height]);l!=null&&(n.width=f(r[0],n.width,1,l),n.height=f(r[2],n.height,1,l))}function p(n,r,l){for(let o=0;o<3;o++){const t=n[o];switch(t){case"symbol-value":{const e=l[o];return e!=null?e/r[o]:1}case"proportional":break;default:if(t&&r[o])return t/r[o]}}return null}async function D(n){const{computeObjectLayerResourceSize:r}=await L(()=>import("./symbolLayerUtils-Zyp81Swx.js"),__vite__mapDeps([0,1,2])),l=await r(n,10),{width:o,height:t,depth:e}=n,c=[o,e,t];let i=1;for(let a=0;a<3;a++){const h=c[a];if(h!=null){i=h/l[a];break}}for(let a=0;a<3;a++)c[a]==null&&(c[a]=l[a]*i);return{resourceSize:l,symbolSize:c}}function f(n,r,l,o){switch(n){case"proportional":return l*o;case"symbol-value":return r??l;default:return n}}function P(n,r){const l=m(r);if(l!=null)switch(n.type){case"simple-marker":n.size=l;break;case"picture-marker":{const o=n.width/n.height;o>1?(n.width=l,n.height=l*o):(n.width=l*o,n.height=l);break}case"simple-line":n.width=l;break;case"text":n.font.size=l}}async function T(n,r){if(n&&r)return y(n)?_(n,r):void(d(n)&&P(n,r))}function U(n,r,l){if(n&&r!=null){if(y(n)){const o=n.symbolLayers;o&&o.forEach(t=>{if(t.type==="object")switch(l){case"tilt":t.tilt=(t.tilt??0)+r;break;case"roll":t.roll=(t.roll??0)+r;break;default:t.heading=(t.heading??0)+r}t.type==="icon"&&(t.angle+=r)})}else if(d(n))switch(n.type){case"simple-marker":case"picture-marker":case"text":n.angle+=r;break;case"cim":v(n,r,!0)}}}function W(n){return n!=null&&n.type==="polygon-3d"&&n.symbolLayers.some(r=>r.type==="extrude")}export{W as A,N as L,T as M,U as N,M as b,J as d,I as h};
