import{R as Y,D as q}from"./ResponsiveTheme-BT4UqD4R.js";import{bK as K,ii as J,ij as Q,ik as O,bg as C,go as W,il as T,ar as _,c5 as ee,im as te,io as G,ip as ie,iq as ne,ir as oe,is as se,it as ae}from"./index-glGZSouV.js";import{h as le,N as re}from"./chartUtilsAm5-DU_POnW8.js";import{X as de,V as k,A as ce,a as ue,b as pe,L as fe}from"./LineSeries-DjT7zqNH.js";import{c as x,e as M,a as xe,C as me}from"./Theme-ypvEf1g8.js";import{T as V}from"./Tooltip-Cj1KvmyH.js";import"./DefaultTheme-BgDdsnlc.js";import"./ColorSet-iHDP2w_9.js";import"./Tick-BuhxDNtX.js";import"./Button-DdHbWmWo.js";function ge(e,i,n=10){const t=z(i-e,!1);if(t===0)return[e,i];const o=z(t/(n-1),!0);return[Math.floor(e/o)*o,Math.ceil(i/o)*o]}function z(e,i){const n=Math.floor(Math.log10(e)),t=e/10**n;let o;return o=i?t<1.5?1:t<3?2:t<5?2.5:t<7?5:10:t<=1?1:t<=2?2:t<=3?2.5:t<=5?5:10,o*10**n}const b="#f8f8f8",E="#a9a9a9",A="#323232",he="line",Ae="fill",v=15,h=12,w=.001,ve=.1,be=.02,I={fontFamily:"Avenir Next",paddingBottom:h/2,paddingLeft:0,paddingRight:0,paddingTop:0,axisGridStroke:"#f4f4f4",axisLabelsFontSize:9,axisLabelsFontWeight:"400",axisLabelsColor:E,axisTooltipFontSize:12,axisTooltipBackgroundColor:A,axisTooltipLabelColor:b,axisTooltipPaddingTop:Math.round(h/4),axisTooltipPaddingBottom:Math.round(h/4),axisTooltipPaddingHorizontal:Math.round(v/4),xAxisMinGridDistance:50,xAxisLabelsSpacing:Math.round(h/2),xAxisMinLabelPosition:.05,xAxisMaxLabelPosition:.9,yAxisMinGridDistance:30,yAxisLabelSpacing:Math.round(v/4),yAxisMinLabelPosition:0,yAxisMaxLabelPosition:.8,seriesTooltipFontSize:12,seriesTooltipBackgroundColor:b,seriesTooltipLabelColor:A,seriesFillLighten:.9,seriesTooltipSpacing:h/2,seriesTooltipPaddingVertical:Math.round(v/4),seriesTooltipPaddingHorizontal:Math.round(v/4)},ye={...I,axisGridStroke:A,axisLabelsColor:E,axisTooltipBackgroundColor:A,axisTooltipLabelColor:b,seriesTooltipBackgroundColor:A,seriesTooltipLabelColor:b,seriesFillLighten:-.75},S={minX:void 0,maxX:void 0,minY:void 0,maxY:void 0};async function qe(e){const i=await le(e.container);K(e.abortOptions);const n=J(e.container),t=n?ye:I;i.setThemes(n?[Y.new(i),q.new(i)]:[Y.new(i)]);const o=Q(e.container),s=i.container.children.push(de.new(i,{panX:!0,panY:!0,paddingTop:t.paddingTop,paddingBottom:t.paddingBottom,paddingLeft:o?t.paddingRight:t.paddingLeft,paddingRight:o?t.paddingLeft:t.paddingRight,maxTooltipDistance:-1}));s.zoomOutButton.set("forceHidden",!0);const a=s.xAxes.push(k.new(i,{renderer:ce.new(i,{})})),l=s.yAxes.push(k.new(i,{renderer:ue.new(i,{})})),d=C(null),r=C("loading"),c={chart:s,xAxis:a,yAxis:l,seriesInfos:new Map,messages:null,theme:t,pointerIsOver:!1,rtl:o,get state(){return r.value},get data(){return d.value},set data(f){d.value=f}};Le(c),Me(c),Te(c);const u=O([we(c,e.onRangeChange),Be(c,e.onCursorPositionChange),X(i.events.once("frameended",()=>{r.value="ready"})),X(i)]);return{destroy:()=>{u.remove(),r.value="destroyed"},update:f=>{f.data===c.data&&f.messages===c.messages||P(c)||Se(c,f)},zoomOut:()=>U(c),test:void 0}}function P(e){return e.state==="destroyed"}function Te({chart:e,xAxis:i,yAxis:n}){const t=pe.new(e.root,{behavior:"none",xAxis:i,yAxis:n,snapToSeriesBy:"y"});t.lineY.set("visible",!1),e.set("cursor",t)}function Le(e){const{chart:i,xAxis:n,theme:t}=e;n.setAll({extraMax:0,extraMin:0,maxDeviation:0,numberFormatter:N(e,"distance"),strictMinMax:!0,strictMinMaxSelection:!0}),n.axisHeader.set("forceHidden",!0);const o=n.get("renderer");o.setAll({inside:!1,minGridDistance:t.xAxisMinGridDistance}),o.labels.template.setAll({centerX:M,centerY:M,fill:x(t.axisLabelsColor),fontFamily:t.fontFamily,fontSize:t.axisLabelsFontSize,fontWeight:t.axisLabelsFontWeight,maxPosition:t.xAxisMaxLabelPosition,minPosition:t.xAxisMinLabelPosition,paddingLeft:0,paddingRight:0,paddingTop:t.xAxisLabelsSpacing});const s=n.set("tooltip",V.new(i.root,{paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0}));s.get("background")?.setAll({fill:x(t.axisTooltipBackgroundColor),stroke:void 0}),s.label.setAll({fill:x(t.axisTooltipLabelColor),fontFamily:t.fontFamily,fontSize:t.axisTooltipFontSize,paddingBottom:t.axisTooltipPaddingBottom,paddingLeft:t.axisTooltipPaddingHorizontal,paddingRight:t.axisTooltipPaddingHorizontal,paddingTop:t.axisTooltipPaddingTop,direction:e.rtl?"rtl":"ltr"}),o.grid.template.setAll({strokeOpacity:1,stroke:x(t.axisGridStroke)})}function Me(e){const{yAxis:i,theme:n,rtl:t}=e;i.setAll({baseValue:T().noDataValue,extraMax:0,extraMin:0,maxDeviation:0,numberFormatter:N(e,"elevation"),strictMinMax:!0,strictMinMaxSelection:!0,tooltip:void 0}),i.axisHeader.set("visible",!1);const o=i.get("renderer");o.setAll({minGridDistance:n.yAxisMinGridDistance,opposite:t,inside:!0}),o.labels.template.setAll({centerX:M,centerY:xe,fill:x(n.axisLabelsColor),fontFamily:n.fontFamily,fontSize:n.axisLabelsFontSize,fontWeight:n.axisLabelsFontWeight,maxPosition:n.yAxisMaxLabelPosition,minPosition:n.yAxisMinLabelPosition,paddingBottom:0,paddingLeft:t?0:n.yAxisLabelSpacing,paddingRight:t?n.yAxisLabelSpacing:0,paddingTop:0,textAlign:"start"}),o.grid.template.setAll({strokeOpacity:1,stroke:x(n.axisGridStroke)})}function Se(e,i){if(P(e))return;const n=e.data??void 0,t=i.data??void 0;e.chart.get("cursor")?.set("forceHidden",!t?.refined);const o=n!==t,s=n?.effectiveUnits!==t?.effectiveUnits,a=n?.uniformScaling!==t?.uniformScaling;e.data=t,e.messages=i.messages,(o||s)&&(Fe(e),Ye(e)),a&&U(e),F(e)}function U(e){P(e)||(e.xAxis.zoom(0,1),e.yAxis.zoom(0,1))}function Fe(e){const{chart:i,data:n,xAxis:t,yAxis:o}=e,{minX:s,maxX:a,minY:l,maxY:d}=Xe({data:n,pixelWidth:t.width(),pixelHeight:o.height()}),r=!!n?.uniformScaling,c=!!n?.refined;i.setAll({panX:!0,panY:r,pinchZoomX:c,pinchZoomY:c&&r,wheelX:"panX",wheelY:c?r?"zoomXY":"zoomX":"none"}),t.setAll({max:a,min:s,panX:!0,panY:!1,zoomX:!0,zoomY:r}),o.setAll({max:d,min:l,panX:!1,panY:r,zoomX:r,zoomY:r})}function Xe({data:e,pixelWidth:i,pixelHeight:n}){if(e==null)return S;const t=e.statistics,o=0,s=t?.maxDistance;let a=t?.minElevation,l=t?.maxElevation;if(s==null||a==null||l==null)return S;const d=Math.max(s-o,w);let r=Math.max(l-a,w);const c=e.effectiveUnits;if(e.dynamicElevationRange){const u=W(d,c.distance,c.elevation);r=Math.max(r,u/T().maxChartRatio)}return a-=be*r,l=a+r+ve*r,[a,l]=ge(a,l,10),r=l-a,e.uniformScaling?Pe({data:e,bounds:{minX:o,maxX:s,minY:a,maxY:l},pixelWidth:i,pixelHeight:n,centered:!0}):{minX:o,maxX:o+d,minY:a,maxY:a+r}}function Pe({data:e,bounds:i,pixelWidth:n,pixelHeight:t,centered:o}){if(e==null)return i;let{minX:s,maxX:a,minY:l,maxY:d}=i;if(s==null||a==null||l==null||d==null)return S;const r=a-s,c=d-l,u=e.effectiveUnits,p=W(c,u.elevation,u.distance)/t/(r/n);return p>=1?[s,a]=B([s,a],p):[l,d]=B([l,d],1/p),{minX:s,maxX:a,minY:l,maxY:d}}function B([e,i],n,t){const o=(i-e)*n;{const s=(e+i)/2-o/2;return[s,s+o]}}function Ye(e){const{chart:i,data:n,seriesInfos:t,xAxis:o,yAxis:s}=e;if(n==null||n.lines.length===0)return void i.series.clear();const a=new Map,l=new Set(i.series.values),d=n.lines.length;for(let r=0;r<d;r++){const c=n.lines[r];let u=t.get(c.id);u?(u.fill&&l.delete(u.fill),l.delete(u.line)):(u=ke(e,c),u.fill&&i.series.push(u.fill),i.series.push(u.line)),a.set(u.id,u);const p=d-r-1;u.fill?.set("layer",p),u.line.set("layer",d+p),Ce(e,u,c)}e.seriesInfos=a;for(const r of l)i.series.removeValue(r);o.set("layer",d+1),s.set("layer",d+2)}function Ce({theme:e},i,n){const t=x(n.color.toCss()),o=n.samples??[],s=o.length>0,{line:a,fill:l}=i;a.set("visible",s),a.set("stroke",t),l?.set("visible",s),l?.set("fill",me.lighten(t,e.seriesFillLighten)),a.data.setAll(o),l?.data.setAll(o)}function ke(e,i){const{id:n}=i,t=H(e,`${he}-${n}`),o=ze(e);t.setAll({dy:i.chartStrokeOffsetY,tooltip:o}),t.strokes.template.setAll({strokeWidth:i.chartStrokeWidth});let s=null;return i.chartFillEnabled&&(s=H(e,`${Ae}-${n}`),s.fills.template.setAll({fillOpacity:1,visible:!0})),{id:n,line:t,fill:s}}function H(e,i){return fe.new(e.chart.root,{connect:!1,excludeFromTotal:!0,fill:void 0,id:i,stroke:void 0,valueXField:"distance",valueYField:"elevation",xAxis:e.xAxis,yAxis:e.yAxis})}function ze({theme:e,chart:i,rtl:n}){const t=V.new(i.root,{autoTextColor:!1,forceHidden:!0,getFillFromSprite:!1,getLabelFillFromSprite:!1,pointerOrientation:"vertical",visible:!1}),o=e.seriesTooltipPaddingHorizontal,s=e.seriesTooltipPaddingVertical;return t.label.setAll({fill:x(e.seriesTooltipLabelColor),fontFamily:e.fontFamily,fontSize:e.seriesTooltipFontSize,paddingBottom:s,paddingLeft:o,paddingRight:o,paddingTop:s,textAlign:n?"end":"start",direction:"ltr"}),t.get("background")?.setAll({stroke:void 0,fill:x(e.seriesTooltipBackgroundColor)}),t.adapters.add("dy",a=>{const l=e.seriesTooltipSpacing,d=t.get("pointTo")?.y??0;return(a??0)+(t.y()>d?l:-l)}),t}function we(e,i){const{xAxis:n,yAxis:t}=e,o=()=>{i(y(n),y(t))},s=a=>[a.on("start",o),a.on("end",o)];return Z([...s(n),...s(t)])}function y(e){const i=Math.abs((e.get("end")??0)-(e.get("start")??0)),n=i!==0?1/i:1;return Math.abs(1-n)<ie()?1:n}function Be(e,i){const{chart:n,xAxis:t,yAxis:o}=e,s=n.get("cursor"),a=n.plotContainer.events,l=r=>{e.pointerIsOver=r,F(e)},d=()=>{l(!1),i(null,null)};return Z([s?.events.on("cursormoved",()=>{if(!e.pointerIsOver)return;F(e);let r=s?.getPrivate("positionX")??0,c=s?.getPrivate("positionY")??0;const u=e.data;if(u?.statistics!=null){const{maxDistance:p,minElevation:f,maxElevation:L}=u.statistics;let m,g;p!=null&&(y(t)===1?(m=0,g=p):(m=$(t),g=D(t)),r=R(r,m,g,0,p)),f!=null&&L!=null&&(y(o)===1?(m=f,g=L):(m=$(o),g=D(o)),c=R(c,m,g,f,L))}i(r,c)}),a.on("pointerover",()=>l(!0)),a.on("pointerout",d),a.on("blur",d)])}function R(e,i,n,t,o){return(i+e*(n-i)-t)/(o-t)}function F(e){const i=He(e);if(!i)return void e.seriesInfos.forEach(n=>{n.line.get("tooltip")?.set("forceHidden",!0)});e.seriesInfos.forEach(n=>{const t=n.line.get("tooltip");t.set("forceHidden",!1),t.label.set("text",i)}),e.xAxis.getTooltip().setAll({tooltipText:De(e)})}function He(e){const{data:i}=e,n=i?.lines.map(t=>({line:t,y:j(e,t)?.elevation})).sort(Re);return n&&n.length!==0&&n[0].y!=null?n.map(({y:t,line:o})=>$e(e,o,t)).join(`
`):null}function Re({y:e},{y:i}){return e==null?1:i==null?-1:i-e}function $e(e,i,n){const{data:t,messages:o}=e;if(t==null||o==null)return"";const s=`[${i.color.toHex()}]â—[/]`,a="  ",l=T().formatPrecision,d=oe(o.chartTooltip,{name:ae(i,o),elevation:n!=null?G(o,n,t.effectiveUnits.elevation,l):se});return e.rtl?d+a+s:s+a+d}function De(e){const{data:i,messages:n}=e;if(i==null||n==null)return"";const t=i.lines[0],o=t?j(e,t):null,s=T().formatPrecision;return o!=null?G(n,o.distance,i.effectiveUnits.distance,s):"-"}function N(e,i){const n=re.new(e.chart.root,{});return n.format=(t,o,s)=>{const{data:a,messages:l}=e;return l==null||a==null||typeof t=="string"?"":`${ee(t,{maximumFractionDigits:s})} ${te(l,a.effectiveUnits[i],"abbr")}`},n}function j({chart:e,xAxis:i},n){const t=n.samples??[];if(t.length===0)return null;const o=e.get("cursor"),s=o?.getPrivate("positionX")??0,a=i.toAxisPosition(s),l=i.positionToValue(a);return ne(t,l,d=>d.distance)}function $(e){return e.positionToValue(e.get("start")??0)}function D(e){return e.positionToValue(e.get("end")??1)}function Z(e){return O(e.map(X))}function X(e){return _(()=>{e?.dispose()})}export{qe as createChart,Xe as getAdjustedBounds};
